# Lab2_1


## Машинное обучение "без учителя". Задача кластеризации.

В практических примерах ниже показано:

'как пользоваться инструментами визуального анализа для предварительной интерпретации кластеров

'как проводить кластерный анализ

'как строить прогноз принадлежности к кластерам новых наблюдений

'как оценивать точность кластеризации


Модели: иерархический и неиерархический кластерный анализ

Данные: load_breast_cancer


Задача состоит в разделении ирисов на группы в зависимости от показателей(mean symmetry, mean concavity)

<img width="128" alt="image" src="https://user-images.githubusercontent.com/98012309/224162229-4b31c045-70e6-455f-a412-0156710449e4.png">

<img width="676" alt="image" src="https://user-images.githubusercontent.com/98012309/224162366-980a8a5a-d887-49ea-af52-41030b8ee8ff.png">

В нашем примере наблюдения визуально нельзя сгруппировать. Поэтому рассмотрим метод для определения наилучшего количества кластеров.

## Определение оптимального количества кластеров для метода локтя

<img width="382" alt="image" src="https://user-images.githubusercontent.com/98012309/224162760-9d3463e6-2e60-407f-803c-5d439214738a.png">

Как видно на следующем выше графике, локоть расположен в k = 4, что свидетельствует о том, что k = 4 является хорошим выбором для этого набора данных.

<img width="375" alt="image" src="https://user-images.githubusercontent.com/98012309/224162955-ef0775dc-f617-438a-9b0e-3c62d037ff7f.png">

Тем не менее, визуальный анализ говорит о наличии 3 различных групп. Сделаем и такое построение:

<img width="371" alt="image" src="https://user-images.githubusercontent.com/98012309/224163087-22179482-a825-412b-96bf-f2533086dad1.png">

Теперь видим, что каждая группа точек покрашена в цвет соответствующего кластера, а центроиды расположены внутри множества точек. Тем не менее, попробуем оценить качество кластеризации в обоих вариантах.


## Количественная оценка качества кластеризации

Посчитаем для k=3 кластеров:

<img width="378" alt="image" src="https://user-images.githubusercontent.com/98012309/224163262-f5c9b3fa-aebe-465b-945b-9f58e35006dd.png">

Средний коэффициент силуэта весьма близок к 0.5 , что говорит о относительным качестве кластеризации. Если силуэты зрительно значительно отличаются друг от друга по длине, то это является признаком субоптимальной кластеризации. Как правило, в этом случае центроиды кластеров стоят отдельно от множества точек кластера. Посчитаем средний силуэтный коэффициент для кластеризации .

Средний коэффициент силуэта -- 0.46110505790261136

Его значение немного ниже, чем в предыдущем случае. Формально  - более оптимальное разбиение.


## Сравнение результатов на обучающей и тестовой выборке

Посмотрим, как прогнозировать новых наблюдений принадлежность к кластерам, построенным по обучающим данным. Сравним значения средних силуэтных коэффициентов.

В обучающей выборке - 80% исходных наблюдений.

Добавляем к выборке дополнительный показатель.

image

image

Как видно на следующем выше графике, заметных изменений не обнаружилось.

Обучаем алгоритм и считаем средний силуэтный коэффициент.

Средний коэффициент силуэта -- 0.5477858909230147

Применяем модель к новым данным. Значение среднего силуэтного коэффициента незначительно ухудшилось.(Средний коэффициент силуэта -- 0.5349948060386395)

Статистический анализ получившихся кластеров
image

Визуально кластеры немного отличаются друг от друга. Судя по графикам плотности, по показателю petal_length имеют различия, а по sepal_length и sepal_width имеют некоторые сходства. По диаграммам разброса видно, что оба кластера образуют не совсем плотное множество точек, разбиение нестрогое.

Оценка точности кластеризации с помощью Acc, сравнив оценки с фактическим разбиением на группы.
Acc для выборки с двумя показателями(sepal length (cm) petal length (cm)):

для разбиения на 2 кластера (Accuracy: 0.64)
для разбиения на 3 кластера (Accuracy: 0.88)
для разбиения на 4 кластера (Accuracy: 0.63)
Из оценки кластеризации следует, что алгоритм(для 3-ёх кластеров) достиг высокой точности в своей работе, указывая правильную категоризацию большинства объектов данных.

Acc для выборки с тремя показателями(sepal length (cm) petal length (cm) sepal width (cm)):

для разбиения на 2 кластера (Accuracy: 0.67)
для разбиения на 3 кластера (Accuracy: 0.453)
для разбиения на 4 кластера (Accuracy: 0.446)

Из оценки кластеризации следует, что алгоритм(при разбиении на 2 кластера) достиг высокой точности в своей работе, указывая правильную категоризацию большинства объектов данных.
